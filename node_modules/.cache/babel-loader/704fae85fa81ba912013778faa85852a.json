{"ast":null,"code":"import _regeneratorRuntime from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./LoginSignup.css\";import Button from\"../Button/Button\";import{Link,useNavigate}from\"react-router-dom\";import{useState}from'react';import{popUpError,validateEmail,LoginRequest}from'../../utils/utils.js';import{sha256}from'js-sha256';import{useAccountData,useAccountDataUpdate}from\"../AccountContext/AccountProvider\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function SignupPage(e){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var _useState3=useState(\"\"),_useState4=_slicedToArray(_useState3,2),inputName=_useState4[0],changeInputName=_useState4[1];var _useState5=useState(\"\"),_useState6=_slicedToArray(_useState5,2),inputEmail=_useState6[0],changeInputEmail=_useState6[1];var _useState7=useState(\"\"),_useState8=_slicedToArray(_useState7,2),inputPassword=_useState8[0],changeInputPassword=_useState8[1];var _useState9=useState(\"\"),_useState10=_slicedToArray(_useState9,2),inputRepeatPassword=_useState10[0],changeRepeatPassword=_useState10[1];var _useState11=useState(\"\"),_useState12=_slicedToArray(_useState11,2),inputDateOfBirth=_useState12[0],changeInputDateOfBirth=_useState12[1];var AccountDataUpdate=useAccountDataUpdate();var navigate=useNavigate();function SignUpRequest(_x){return _SignUpRequest.apply(this,arguments);}function _SignUpRequest(){_SignUpRequest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(obj){var response;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch(\"http://localhost:3000/signup?name=\".concat(obj.name,\"&password=\").concat(obj.password,\"&email_address=\").concat(obj.email_address,\"&date_of_birth=\").concat(obj.date_of_birth));case 2:response=_context2.sent;_context2.next=5;return response.json();case 5:return _context2.abrupt(\"return\",_context2.sent);case 6:case\"end\":return _context2.stop();}}},_callee2);}));return _SignUpRequest.apply(this,arguments);}var handleForm=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var response,loginResponse;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();//complete all fields\nif(!(inputName===''||inputEmail===''||inputPassword===''||inputRepeatPassword===''||inputDateOfBirth==='')){_context.next=5;break;}setError(\"Complete all fields.\");popUpError();return _context.abrupt(\"return\");case 5:if(validateEmail(inputEmail)){_context.next=9;break;}setError(\"Email address is invalid.\");popUpError();return _context.abrupt(\"return\");case 9:if(!(inputRepeatPassword!==inputPassword)){_context.next=13;break;}setError(\"Passwords do not match.\");popUpError();return _context.abrupt(\"return\");case 13:_context.next=15;return SignUpRequest({name:inputName,password:sha256(inputPassword),email_address:inputEmail,date_of_birth:inputDateOfBirth});case 15:response=_context.sent;if(response.error){_context.next=24;break;}_context.next=19;return LoginRequest({email:inputEmail,password:sha256(inputPassword)});case 19:loginResponse=_context.sent;AccountDataUpdate({isLoggedIn:true,userData:{userId:loginResponse.content.userId,userName:loginResponse.content.userName,userEmail:loginResponse.content.userEmail,token:loginResponse.content.token}});//redirect to Home\nnavigate(\"/\");_context.next=28;break;case 24:setError(response.content);console.log(response);popUpError();return _context.abrupt(\"return\");case 28:case\"end\":return _context.stop();}}},_callee);}));return function handleForm(_x2){return _ref.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{className:\"signup-additional-text\",children:\"Having an account helps you tracking your tickets and booking tickets more easily.\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-signup-form-container\",children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Sign up\"}),/*#__PURE__*/_jsxs(\"form\",{children:[/*#__PURE__*/_jsx(\"label\",{children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"name\",required:true,onChange:function onChange(e){changeInputName(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Email adress\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"email\",required:true,onChange:function onChange(e){changeInputEmail(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"password\",required:true,onChange:function onChange(e){changeInputPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Repeat password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",placeholder:\"password\",required:true,onChange:function onChange(e){changeRepeatPassword(e.target.value);}}),/*#__PURE__*/_jsx(\"label\",{children:\"Date of birth\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",required:true,onChange:function onChange(e){changeInputDateOfBirth(e.target.value);}}),/*#__PURE__*/_jsx(\"p\",{id:\"account-error\",children:error}),/*#__PURE__*/_jsx(Button,{text:\"Create account\",event:handleForm}),/*#__PURE__*/_jsx(Link,{to:\"/login\",children:\"Already have an account? Login!\"})]})]})]});}export default SignupPage;","map":{"version":3,"sources":["D:/react/remigoo/src/Components/PageLoginSignup/SignupPage.js"],"names":["Button","Link","useNavigate","useState","popUpError","validateEmail","LoginRequest","sha256","useAccountData","useAccountDataUpdate","SignupPage","e","error","setError","inputName","changeInputName","inputEmail","changeInputEmail","inputPassword","changeInputPassword","inputRepeatPassword","changeRepeatPassword","inputDateOfBirth","changeInputDateOfBirth","AccountDataUpdate","navigate","SignUpRequest","obj","fetch","name","password","email_address","date_of_birth","response","json","handleForm","preventDefault","email","loginResponse","isLoggedIn","userData","userId","content","userName","userEmail","token","console","log","target","value"],"mappings":"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","sourcesContent":["import \"./LoginSignup.css\";\r\nimport Button from \"../Button/Button\";\r\nimport {Link,useNavigate} from \"react-router-dom\";\r\nimport {useState} from 'react';\r\nimport {popUpError,validateEmail,LoginRequest} from '../../utils/utils.js'\r\nimport { sha256 } from 'js-sha256';\r\nimport {useAccountData, useAccountDataUpdate} from \"../AccountContext/AccountProvider\";\r\n\r\nfunction SignupPage(e) {\r\n    const [error,setError] = useState(\"\")\r\n    const [inputName,changeInputName] = useState(\"\")\r\n    const [inputEmail,changeInputEmail] = useState(\"\")\r\n    const [inputPassword,changeInputPassword] = useState(\"\")\r\n    const [inputRepeatPassword,changeRepeatPassword] = useState(\"\")\r\n    const [inputDateOfBirth,changeInputDateOfBirth] = useState(\"\")\r\n\r\n    const AccountDataUpdate = useAccountDataUpdate()\r\n    const navigate = useNavigate();\r\n\r\n    async function SignUpRequest(obj){\r\n        const response = await fetch(`http://localhost:3000/signup?name=${obj.name}&password=${obj.password}&email_address=${obj.email_address}&date_of_birth=${obj.date_of_birth}`)\r\n        return await response.json()\r\n\r\n    }\r\n\r\n    const handleForm = async (e)=>{\r\n        e.preventDefault();\r\n\r\n        //complete all fields\r\n        if(inputName === '' || inputEmail === '' || inputPassword === '' || inputRepeatPassword === '' || inputDateOfBirth=== ''){\r\n            setError(\"Complete all fields.\")\r\n            popUpError()\r\n            return;\r\n        }\r\n\r\n        //email validation\r\n        if(!validateEmail(inputEmail)){\r\n            setError(\"Email address is invalid.\")\r\n            popUpError()\r\n            return;\r\n        }\r\n\r\n        //passwords match\r\n        if(inputRepeatPassword !== inputPassword){\r\n            setError(\"Passwords do not match.\")\r\n            popUpError()\r\n            return;\r\n        }\r\n\r\n        const response = await SignUpRequest({\r\n            name:inputName,\r\n            password:sha256(inputPassword),\r\n            email_address:inputEmail,\r\n            date_of_birth:inputDateOfBirth\r\n        })\r\n\r\n        if(!response.error){\r\n            const loginResponse = await LoginRequest({\r\n                email:inputEmail,\r\n                password:sha256(inputPassword)\r\n            })\r\n\r\n            AccountDataUpdate({\r\n                isLoggedIn: true,\r\n                userData: {\r\n                    userId: loginResponse.content.userId,\r\n                    userName: loginResponse.content.userName,\r\n                    userEmail: loginResponse.content.userEmail,\r\n                    token: loginResponse.content.token\r\n                }\r\n            })\r\n\r\n            //redirect to Home\r\n            navigate(\"/\");\r\n        }\r\n        else{\r\n            setError(response.content)\r\n            console.log(response)\r\n            popUpError()\r\n            return;\r\n        }\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <p className=\"signup-additional-text\">Having an account helps you tracking your tickets and booking tickets more easily.</p>\r\n        <div className=\"login-signup-form-container\">\r\n\r\n            <h2>Sign up</h2>\r\n            <form>\r\n                <label>Name</label>\r\n                <input type=\"text\" placeholder=\"name\" required onChange={(e)=>{changeInputName(e.target.value)}}/>\r\n\r\n                <label>Email adress</label>\r\n                <input type=\"text\" placeholder=\"email\" required onChange={(e)=>{changeInputEmail(e.target.value)}}/>\r\n\r\n                <label>Password</label>\r\n                <input type=\"password\" placeholder=\"password\" required onChange={(e)=>{changeInputPassword(e.target.value)}}/>\r\n\r\n                <label>Repeat password</label>\r\n                <input type=\"password\" placeholder=\"password\" required onChange={(e)=>{changeRepeatPassword(e.target.value)}}/>\r\n\r\n                <label>Date of birth</label>\r\n                <input type=\"date\" required onChange={(e)=>{changeInputDateOfBirth(e.target.value)}}/>\r\n\r\n                <p id=\"account-error\">{error}</p>\r\n\r\n                <Button text=\"Create account\" event={handleForm}/>\r\n\r\n                <Link to=\"/login\">Already have an account? Login!</Link>\r\n\r\n            </form>\r\n        </div>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default SignupPage;\r\n"]},"metadata":{},"sourceType":"module"}