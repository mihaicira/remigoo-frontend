{"ast":null,"code":"import _regeneratorRuntime from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/react/remigoo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./ProfilePage.css\";import HeaderText from\"../HeaderText/HeaderText\";import TicketInfo from\"./TicketInfo/TicketInfo\";import AccountDataSection from\"./AccountDataSection/AccountDataSection\";import{useAccountData,useAccountDataUpdate}from\"../AccountContext/AccountProvider\";import{useEffect,useState}from'react';import{useNavigate}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function ProfilePage(props){var AccountDataUpdate=useAccountDataUpdate();var AccountData=useAccountData();var navigate=useNavigate();var _useState=useState({}),_useState2=_slicedToArray(_useState,2),userData=_useState2[0],setUserdata=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),ageCategory=_useState4[0],setAgeCategory=_useState4[1];function GetUserRequest(_x){return _GetUserRequest.apply(this,arguments);}function _GetUserRequest(){_GetUserRequest=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(email){var response,data;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return fetch(\"http://localhost:3000/?type=getuser&email_address=\".concat(email));case 2:response=_context3.sent;_context3.next=5;return response.json();case 5:data=_context3.sent;setUserdata(data.content);return _context3.abrupt(\"return\",data);case 8:case\"end\":return _context3.stop();}}},_callee3);}));return _GetUserRequest.apply(this,arguments);}var refreshUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(email){var response;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return GetUserRequest(email);case 2:response=_context.sent;if(response.error)navigate('/');setUserdata(response.content);console.log(\"User refreshed. Response:\",response.content);case 6:case\"end\":return _context.stop();}}},_callee);}));return function refreshUser(_x2){return _ref.apply(this,arguments);};}();useEffect(function(){setAgeCategory(\"pensionary\");function effectFunction(){return _effectFunction.apply(this,arguments);}function _effectFunction(){_effectFunction=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var storageData;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:storageData=JSON.parse(localStorage.getItem(\"loginStatus\"));if(storageData.isLoggedIn){_context2.next=4;break;}navigate('/');return _context2.abrupt(\"return\");case 4://getuser\nrefreshUser(storageData.userData.userEmail);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return _effectFunction.apply(this,arguments);}effectFunction();},[]);var changeAgeCategory=function changeAgeCategory(newCategory){setAgeCategory(newCategory);// fetch(`http://localhost:3000/?type=getuser&email_address=${email}`)\n};return/*#__PURE__*/_jsxs(_Fragment,{children:[AccountData.isLoggedIn&&/*#__PURE__*/_jsx(HeaderText,{text:\"Hello, \".concat(AccountData.userData.userName,\"!\")}),/*#__PURE__*/_jsx(\"div\",{className:\"change-ticket-category-container\",children:ageCategory&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Change your ticket category\"}),/*#__PURE__*/_jsxs(\"select\",{type:\"text\",defaultValue:ageCategory,onChange:function onChange(e){return changeAgeCategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{value:\"standard\",children:\"Standard\"}),/*#__PURE__*/_jsx(\"option\",{value:\"child\",children:\"Child (\\u226414 y/o)\"}),/*#__PURE__*/_jsx(\"option\",{value:\"student\",children:\"Student\"}),/*#__PURE__*/_jsx(\"option\",{value:\"pensionary\",children:\"Pensionary\"})]})]})}),/*#__PURE__*/_jsx(TicketInfo,{}),/*#__PURE__*/_jsx(HeaderText,{text:\"Account data\"}),/*#__PURE__*/_jsx(AccountDataSection,{name:userData.userName,email:userData.userEmail,id:userData.userId,refreshUser:refreshUser})]});}export default ProfilePage;","map":{"version":3,"sources":["D:/react/remigoo/src/Components/PageProfile/ProfilePage.js"],"names":["HeaderText","TicketInfo","AccountDataSection","useAccountData","useAccountDataUpdate","useEffect","useState","useNavigate","ProfilePage","props","AccountDataUpdate","AccountData","navigate","userData","setUserdata","ageCategory","setAgeCategory","GetUserRequest","email","fetch","response","json","data","content","refreshUser","error","console","log","effectFunction","storageData","JSON","parse","localStorage","getItem","isLoggedIn","userEmail","changeAgeCategory","newCategory","userName","e","target","value","userId"],"mappings":"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","sourcesContent":["import \"./ProfilePage.css\";\r\nimport HeaderText from \"../HeaderText/HeaderText\";\r\nimport TicketInfo from \"./TicketInfo/TicketInfo\";\r\nimport AccountDataSection from \"./AccountDataSection/AccountDataSection\";\r\nimport {useAccountData, useAccountDataUpdate} from \"../AccountContext/AccountProvider\";\r\nimport {useEffect,useState} from 'react';\r\nimport {useNavigate} from \"react-router-dom\";\r\n\r\nfunction ProfilePage(props) {\r\n\r\n    const AccountDataUpdate = useAccountDataUpdate()\r\n    const AccountData = useAccountData()\r\n    const navigate = useNavigate();\r\n    const [userData,setUserdata] = useState({})\r\n    const [ageCategory,setAgeCategory] = useState(null)\r\n\r\n    async function GetUserRequest(email){\r\n        const response = await fetch(`http://localhost:3000/?type=getuser&email_address=${email}`)\r\n        const data = await response.json();\r\n        setUserdata(data.content)\r\n        return data;\r\n    }\r\n\r\n    const refreshUser = async (email) =>{\r\n        const response = await GetUserRequest(email)\r\n\r\n        if(response.error)\r\n            navigate('/')\r\n\r\n        setUserdata(response.content)\r\n\r\n        console.log(\"User refreshed. Response:\",response.content)\r\n    }\r\n\r\n    useEffect(()=>{\r\n        setAgeCategory(\"pensionary\")\r\n\r\n        async function effectFunction(){\r\n            const storageData = JSON.parse(localStorage.getItem(\"loginStatus\"))\r\n            if(!storageData.isLoggedIn){\r\n                navigate('/')\r\n                return;\r\n            }\r\n\r\n\r\n            //getuser\r\n            refreshUser(storageData.userData.userEmail)\r\n        }\r\n\r\n        effectFunction()\r\n    },[])\r\n\r\n    const changeAgeCategory = (newCategory) =>{\r\n        setAgeCategory(newCategory)\r\n        // fetch(`http://localhost:3000/?type=getuser&email_address=${email}`)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            {AccountData.isLoggedIn && <HeaderText text={`Hello, ${AccountData.userData.userName}!`}/>}\r\n\r\n            <div className=\"change-ticket-category-container\">\r\n                {\r\n                    ageCategory &&\r\n                        <>\r\n                            <h2>Change your ticket category</h2>\r\n                            <select type=\"text\" defaultValue={ageCategory} onChange={e=>changeAgeCategory(e.target.value)}>\r\n                                <option value=\"standard\">Standard</option>\r\n                                <option value=\"child\">Child (&le;14 y/o)</option>\r\n                                <option value=\"student\">Student</option>\r\n                                <option value=\"pensionary\">Pensionary</option>\r\n                            </select>\r\n                        </>\r\n                }\r\n\r\n            </div>\r\n\r\n            <TicketInfo/>\r\n\r\n            <HeaderText text={`Account data`}/>\r\n            <AccountDataSection name={userData.userName} email={userData.userEmail} id={userData.userId} refreshUser={refreshUser}/>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default ProfilePage;\r\n"]},"metadata":{},"sourceType":"module"}